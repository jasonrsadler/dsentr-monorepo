# Components Agent Notes

## Change Reasons
- Workflow canvas nodes now render minimal on-canvas shells, auto-open the flyout on selection, and defer configuration (and any API-backed dropdowns like Asana's) to the flyout only to avoid heavy loads during workflow hydration.
- Asana workspace dropdown fetches now run once per visible connection instead of refiring on each render, preventing repeated backend/API calls when opening the flyout.
- Asana project dropdown fetches are now gated the same way as workspace fetches, so opening the flyout no longer hammers the backend/Asana when the project field is visible.
- Asana task dropdown fetches now respect the same guards (connection/workspace/project + visibility) to stop repeated backend/Asana calls when task/parent/comment selectors are shown in the flyout.
- Asana delete task operation now surfaces the project selector once a workspace is picked so users can choose the task from the project-scoped dropdown just like update task.
- Asana move task operation now surfaces the project selector after picking a workspace so tasks/sections can be chosen within that project.
- Asana create subtask operation now surfaces the project selector after choosing a workspace so the task and parent subtask selectors are scoped to that project.
- Asana create subtask now shows the parent task dropdown as soon as a project is selected so a parent task can be chosen before filling subtask details.
- Asana create subtask now displays the same post-project fields (name, assignee, notes, due, additional fields) as create task, but only after a parent task is selected to avoid showing details prematurely.
- Asana create subtask now places the due field toggle immediately after assignee (once a parent task is selected) to switch between due on/due at and show the matching picker set.
- Asana create subtask optional field rendering no longer duplicates assignee/notes/due/additional fields; rest-list filtering now treats createSubtask like create/update task.
- Asana list subtasks operation now shows the project selector after picking a workspace so parent task selection can be scoped to a project.
- Asana list subtasks now reveals the parent task selector once a project is chosen so subtasks can be scoped to a specific task.
- Asana add comment operation now shows the project dropdown after selecting a workspace so tasks can be chosen from that project before adding a comment.
- Asana remove comment operation now shows the project dropdown after selecting a workspace so tasks/comments can be chosen from that project before removal.
- Asana create task now treats project selection as optional with a default "No Project" option, surfaces the name/other optional fields as soon as a workspace is chosen, and pins the project dropdown as the first optional field so tasks can be created without assigning a project.
- Asana update task now offers a "No Project" option, shows a manual Task GID input in that path (fetching task details on blur and auto-populating fields), hides the task dropdown when manual entry is used, and still surfaces optional fields once a task GID is present.
- Manual Task GID entry in Asana update task no longer triggers an API fetch or auto-prefill; dropdown task selection still pre-fills fields as before.
- Asana get task shows the project dropdown after workspace selection and the task dropdown after project selection to restore the expected dependency flow.
- Asana list tasks adds a "No Project" option, exposes tag/assignee alongside workspace, and validates that either project, tag, or assignee+workspace is provided to match Asana API requirements.
- Asana list tasks now includes "No Tag" and "No Assignee" options in their dropdowns to make the required filter combinations explicit.
- Asana delete task now supports a "No Project" path that swaps the task dropdown for a manual Task GID input when no project is selected.
- Added a Pricing link to the marketing navigation (desktop and mobile), refreshed the public nav styling, and added a signed-in Dashboard shortcut ahead of logout.
- HTTP Request node: surface a warning when the URL targets `VITE_API_BASE_URL` so users avoid self-calling workflows that can loop indefinitely and rack up overage charges.
- Google Sheets action: guard against automatically falling back to the personal credential after a shared workspace connection is removed by tracking when a workspace selection is cleared. This keeps users from silently swapping credentials and mirrors the React Flow safety patterns for avoiding redundant updates.
- UI: Unified scrollbar theming across scrollable components to match the Settings modal.
- Applied the shared `themed-scroll` utility class to elements with `overflow-auto`/`overflow-y-auto` for consistent, theme-aware scrollbars in light and dark modes.
- Settings �+' Workflows: added a Runaway Protection toggle that reads/writes per-workspace `runaway_protection_enabled` via the options user-settings API with optimistic updates so users can disable the guard when needed.
- TeamsAction: Prevented duplicate store writes for no-op input changes by tracking the last committed params in a ref and short-circuiting when the next state is identical. This avoids redundant `updateNodeData` calls that can cause render thrash in tests and the canvas.
- Plan tab plan-usage refresh now scopes workspace requests to Workspace plans so solo users still load usage successfully.
- SMTPAction: Improved accessibility of TLS radio options by marking helper text as `aria-hidden` and adding `aria-label` to radio inputs so `getByLabelText` works under jsdom. Also compute validation on each field change and include `hasValidationErrors` in the same `updateNodeData` payload to keep store state in sync with UI.
- Signup form: Excluded the required asterisk from accessible labels (`aria-hidden`) so tests can select the `Password` field by its exact label.
- Members tab: Added an ownership transfer confirmation modal so current owners are warned they'll lose the role and must rely on the new owner to regain it before promoting another member.
- Members tab: Removed the ability to transfer ownership to another member so each user can retain ownership of only their own workspace.
- RunCustomCodeAction: Added a lightweight help tooltip ("?") with concise guidance on how to reference inputs in code using `${inputs.*}`, how to map outputs to properties of a returned JSON object, and how to reference a primitive return via `${{<run code node name>.result}}`. Implemented with local state only to avoid unnecessary store writes and prevent canvas re-render loops.
- WebhooksTab: Updated HMAC instructions to match backend behavior. Preferred header-based verification using `X-DSentr-Timestamp` and `X-DSentr-Signature` (HMAC over `ts + '.' + canonical_json_body` with base64url-decoded key). Documented legacy body fields (`_dsentr_ts`/`_dsentr_sig`) with signing over the body excluding those fields. Added copyable examples for Bash (curl), PowerShell, and Node.
- WebhooksTab: Added positive confirmation states for the Signing Key "Copy" button ("Copied!") and HMAC settings "Save" button ("Saving…" → "Saved!") to clearly indicate the action was applied.
- WebhooksTab: Restored copy-to-clipboard controls for the HMAC language examples and added a signing key rotation button that surfaces success state, refreshes the derived webhook URL, and warns that both credentials change together.
- WebhooksTab: Displays per-trigger webhook endpoints (base URL plus trigger name), updates examples/copy helpers to use the selected trigger URL, and refreshes trigger lists when tokens or signing keys rotate.
- IntegrationsTab: Removed redundant client-side filtering of workspace OAuth connections by `workspaceId`. Backend now enforces workspace scoping for the connections listing endpoint, so the UI consumes the `workspace` array as returned.
- Integrations connect buttons now request a workflow auto-save before redirecting to provider OAuth pages so unsaved canvas edits aren't lost during auth flows.
- Node inline secret creation fields now disable browser/password-manager autofill (autocomplete off/new-password + lp/1p ignore) so quick-create flows don't get prefilled with unrelated credentials.
- Delay and Formatter logic nodes now use inline component delete confirmations instead of `window.confirm`, matching other workflow node modals on the canvas.
- Settings > Integrations: converted provider cards to collapsible accordion items (default collapsed) so the collapsed view only shows the provider name/icon space while keeping expanded content identical for future provider additions.
- Settings > Integrations: added a brief expand/collapse animation on accordion content so the UI feels responsive without altering existing card details or actions.
- Integration tab tests now expand accordion sections before interacting so assertions remain valid with the default-collapsed layout.
- Integration tab revocation/removal tests now open accordion panels before querying actions to match the collapsed default state.
- Settings > Integrations: mapped providers to dedicated logo components and render the Slack logo inside the 40x40 placeholder while keeping the slot reusable for future provider icons.
- Slack logo SVG now uses a padded viewBox and full-size scaling so it fits cleanly within the 40x40 header placeholder without crowding the border.
- Settings > Integrations: support multiple personal/workspace connections per provider, add provider search filtering, surface connection IDs, and keep per-connection actions usable when starting new connection flows.
- Settings > Integrations: refresh/disconnect actions now require explicit connection IDs, disable controls when an ID is unavailable, and avoid provider-only requests to mirror backend enforcement.
- Settings > Integrations: clearing a shared workspace connection now recalculates per-connection sharing so Promote reappears immediately without a refresh, even when other workspace connections remain.
- Workflow action OAuth selectors now keep personal connections as per-provider arrays so multiple personal credentials appear instead of collapsing to a single entry.
- Google Sheets flyout picker now sends client/app IDs, scope, and the fetched OAuth token to Drive Picker and blocks missing-config cases so the picker works in the flyout without console errors.
- Delay and Formatter nodes now mirror other action nodes: canvas cards are minimal and configuration is handled exclusively in the flyout.
- Slack action channel selection now hides the manual input when an OAuth connection is chosen and loads channels into a dropdown from the backend Slack channels endpoint.
- Asana action flyout: dropdowns (operation/workspace/project/task/assignee/section/tag/comment) are searchable when large, project/task/tag/assignee/comment now include manual options with GID inputs that sync selection states, due date/time fields mirror ISO text inputs, and the add-task-to-project flow uses task GID + project selection only (no section picker).
- Asana action build hygiene: removed unused fetch import, simplified required-field ordering for add-task-to-project, and tightened API normalization to keep TS builds passing alongside the templated GID inputs.
- Asana action inputs no longer trim user-entered text on change, preserving whitespace while typing; trimming happens later during validation/templating.
- Formatter node config now preserves whitespace while typing (no trimming on change) and defers string cleanup to validation so text fields keep the user's in-progress spacing.

## Affected Areas
- Settings > LogsTab: change history list
- Settings > WebhooksTab: code examples and raw payload blocks
- UI > Dialogs: `JsonDialog` content area
- UI > InputFields: dropdown menus for nodes and secrets
- UI > Schedule: time and timezone pickers
  - Removed redundant "Remove repeat" action in Trigger node (repeat is toggled via the header control).
- Workflow > Actions: email provider dropdowns, Teams mentions list
- Workflow > Trigger: trigger type dropdown

Styles live in `src/css/globals.css` under `.themed-scroll` and were previously used by `SettingsModal`.
- Added support components (header issue button and modal) so users can submit issue reports with their account/workspace context to the backend.
- Added a message center modal and header badge button so users can read admin replies, mark them read, and reply without leaving the dashboard.
- Added a Delay (Wait) node configuration UI and validation so the workflow designer can pause flows without manual code.
- Added a Formatter logic node UI with grouped dropdown selection, validation, and palette/flyout wiring so users can transform data without new components or custom styling.
- Workflow nodes: dashed summary areas now show an explicit click affordance (hover overlay + pointer cursor) and open the flyout on mouseup without interfering with node dragging, fixing missed flyout openings when using the on-card hint zone.
- Delay and Formatter nodes now use the same dashed hint surface to open their flyouts, matching the rest of the node cards.
